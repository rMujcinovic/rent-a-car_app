import { useQuery } from '@tanstack/react-query'; import { api } from '../api/client'; import { Car } from '../api/types'; import { Link, useSearchParams } from 'react-router-dom'; import { Input, Select } from '../components/UI'
export default function CarsPage(){ const [sp,setSp]=useSearchParams(); const page=Number(sp.get('page')||1); const {data,isLoading}=useQuery({queryKey:['cars',sp.toString()],queryFn:async()=> (await api.get('/cars',{params:Object.fromEntries(sp)})).data}); if(isLoading) return <p>Loading...</p>; const cars:Car[]=data.items; return <div className='space-y-3'><h1 className='text-xl'>Cars</h1><div className='grid grid-cols-2 md:grid-cols-6 gap-2'><Input placeholder='search' defaultValue={sp.get('q')||''} onBlur={e=>{sp.set('q',e.target.value);setSp(sp)}}/><Select defaultValue={sp.get('status')||''} onChange={e=>{sp.set('status',e.target.value);setSp(sp)}}><option value=''>all status</option><option>available</option><option>rented</option><option>maintenance</option></Select><Select defaultValue={sp.get('sort')||'newest'} onChange={e=>{sp.set('sort',e.target.value);setSp(sp)}}><option value='newest'>Newest</option><option value='price_asc'>Price asc</option><option value='price_desc'>Price desc</option><option value='year'>Year</option></Select></div><div className='grid md:grid-cols-3 gap-3'>{cars.map(c=><Link key={c.id} to={`/cars/${c.id}`} className='bg-white rounded p-3 block'><img src={c.images?.[0]} className='h-36 w-full object-cover rounded'/><h2>{c.brand} {c.model}</h2><p>${c.dailyPrice}/day</p></Link>)}</div>{cars.length===0&&<p>No cars found.</p>}<div className='flex gap-2'><button disabled={page<=1} onClick={()=>{sp.set('page',String(page-1));setSp(sp)}}>Prev</button><button onClick={()=>{sp.set('page',String(page+1));setSp(sp)}}>Next</button></div></div> }
